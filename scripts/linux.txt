RUN echo "正在为您安装homebrew"
RUN if command -v python3 >/dev/null; then sudo apt-get install -y build-essential curl file git; elif command -v yum > /dev/null; then sudo yum groupinstall 'Development Tools' && sudo yum install curl file git; fi
RUN sh -c "$(curl -fsSL https://hahack-1253537070.file.myqcloud.com/misc/homebrew/linux/linux.sh)"
RUN test -d ~/.linuxbrew && eval $(~/.linuxbrew/bin/brew shellenv)
RUN test -d /home/linuxbrew/.linuxbrew && eval $(/home/linuxbrew/.linuxbrew/bin/brew shellenv)
RUN test -r ~/.bash_profile && echo "eval \$($(brew --prefix)/bin/brew shellenv)" >>~/.bash_profile
RUN echo "eval \$($(brew --prefix)/bin/brew shellenv)" >>~/.profile
RUN cd $(brew --repo) && git remote set-url origin https://mirrors.tuna.tsinghua.edu.cn/git/homebrew/brew.git
RUN cd "$(brew --repo)/Library/Taps/homebrew/homebrew-core" && git remote set-url origin https://mirrors.tuna.tsinghua.edu.cn/git/homebrew/homebrew-core.git
RUN brew update
RUN echo 'export HOMEBREW_BOTTLE_DOMAIN=https://mirrors.tuna.tsinghua.edu.cn/homebrew-bottles' >> ~/.bash_profile
RUN source ~/.bash_profile
RUN echo "正在为您安装wukong-starter"
RUN brew install python3 portaudio sox ffmpeg swig
RUN pip3 install --upgrade pip
RUN pip3 config set global.index-url https://pypi.tuna.tsinghua.edu.cn/simple
RUN pip3 install virtualenv
WORKDIR ${PWD}
RUN virtualenv --no-site-packages wukong
RUN pip3 install pyaudio
WORKDIR ~
RUN wget http://hahack-1253537070.file.myqcloud.com/misc/snowboy.tar.bz2
RUN tar -xvjf snowboy.tar.bz2
RUN rm snowboy.tar.bz2
WORKDIR ~/snowboy/swig/Python3
RUN make
RUN cp _snowboydetect.so ${PWD}/snowboy/
RUN rm -rf ~/snowboy
RUN "wukong-starter 已安装完成!"
